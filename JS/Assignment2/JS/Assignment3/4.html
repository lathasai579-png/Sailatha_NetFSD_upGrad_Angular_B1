<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mini Expense Tracker</title>
</head>
<body>

<h2>Mini Expense Tracker (IndexedDB)</h2>

Expense Title:
<input type="text" id="title"><br><br>

Amount:
<input type="number" id="amount"><br><br>

Date:
<input type="date" id="date"><br><br>

<button onclick="addExpense()">Add Expense</button>
<button onclick="viewExpenses()">View Expenses</button>

<h3>Expense List</h3>
<ul id="expenseList"></ul>

<script>

let db;

let request = indexedDB.open("ExpenseDB", 1);

request.onupgradeneeded = function(e) {
    db = e.target.result;
    db.createObjectStore("expenses", { keyPath: "id", autoIncrement: true });
};

request.onsuccess = function(e) {
    db = e.target.result;
};

function addExpense() {

    let title = document.getElementById("title").value;
    let amount = document.getElementById("amount").value;
    let date = document.getElementById("date").value;

    let transaction = db.transaction(["expenses"], "readwrite");
    let store = transaction.objectStore("expenses");

    store.add({ title, amount, date });

    alert("Expense Added!");
}

function viewExpenses() {

    let list = document.getElementById("expenseList");
    list.innerHTML = "";

    let transaction = db.transaction(["expenses"], "readonly");
    let store = transaction.objectStore("expenses");

    let request = store.openCursor();

    request.onsuccess = function(e) {
        let cursor = e.target.result;

        if(cursor) {
            let li = document.createElement("li");
            li.innerHTML = `
            ${cursor.value.title} - â‚¹${cursor.value.amount} - ${cursor.value.date}
            <button onclick="deleteExpense(${cursor.value.id})">Delete</button>
            `;
            list.appendChild(li);
            cursor.continue();
        }
    };
}

function deleteExpense(id) {

    let transaction = db.transaction(["expenses"], "readwrite");
    let store = transaction.objectStore("expenses");

    store.delete(id);

    alert("Expense Deleted!");
    viewExpenses();
}

</script>

</body>
</html>